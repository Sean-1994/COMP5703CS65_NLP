(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ce1a440a"],{"2a0c":function(t,e,n){},"3ee3":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"task-status"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:6}},[n("div",{staticClass:"panel"},[n("panel-title",{attrs:{title:t.$lang.objects.task}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$router.push({name:"taskEdit",params:{id:t.id}})}}},[n("i",{staticClass:"fa fa-edit"}),t._v("\n            "+t._s(t.$lang.buttons.edit)+"\n          ")])],1),t.task?n("div",{staticClass:"panel-body"},[n("el-form",{attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:t.$lang.columns.trigger}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.trigger))])],1),t.task.configuration?n("div",["date"===t.task.trigger?n("div",[n("el-form-item",{attrs:{label:t.$lang.columns.runDate}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.run_date))])],1),n("el-form-item",{attrs:{label:t.$lang.columns.timezone}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.timezone))])],1)],1):t._e(),"interval"===t.task.trigger?n("div",[null!==t.task.configuration.weeks?n("el-form-item",{attrs:{label:t.$lang.columns.weeks}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.weeks))])],1):t._e(),null!==t.task.configuration.days?n("el-form-item",{attrs:{label:t.$lang.columns.days}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.days))])],1):t._e(),null!==t.task.configuration.hours?n("el-form-item",{attrs:{label:t.$lang.columns.hours}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.hours))])],1):t._e(),null!==t.task.configuration.minutes?n("el-form-item",{attrs:{label:t.$lang.columns.minutes}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.minutes))])],1):t._e(),null!==t.task.configuration.seconds?n("el-form-item",{attrs:{label:t.$lang.columns.seconds}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.seconds))])],1):t._e(),n("el-form-item",{attrs:{label:t.$lang.columns.timezone}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.timezone))])],1),null!==t.task.configuration.start_date?n("el-form-item",{attrs:{label:t.$lang.columns.startDate}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.start_date))])],1):t._e(),null!==t.task.configuration.end_date?n("el-form-item",{attrs:{label:t.$lang.columns.endDate}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.end_date))])],1):t._e()],1):t._e(),"cron"===t.task.trigger?n("div",[null!==t.task.configuration.year?n("el-form-item",{attrs:{label:t.$lang.columns.year}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.year))])],1):t._e(),null!==t.task.configuration.month?n("el-form-item",{attrs:{label:t.$lang.columns.month}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.month))])],1):t._e(),null!==t.task.configuration.week?n("el-form-item",{attrs:{label:t.$lang.columns.week}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.week))])],1):t._e(),null!==t.task.configuration.day_of_week?n("el-form-item",{attrs:{label:t.$lang.columns.dayOfWeek}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.day_of_week))])],1):t._e(),null!==t.task.configuration.day?n("el-form-item",{attrs:{label:t.$lang.columns.day}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.day))])],1):t._e(),null!==t.task.configuration.hour?n("el-form-item",{attrs:{label:t.$lang.columns.hour}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.hour))])],1):t._e(),null!==t.task.configuration.minute?n("el-form-item",{attrs:{label:t.$lang.columns.minute}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.minute))])],1):t._e(),null!==t.task.configuration.second?n("el-form-item",{attrs:{label:t.$lang.columns.second}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.second))])],1):t._e(),n("el-form-item",{attrs:{label:t.$lang.columns.timezone}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.timezone))])],1),null!==t.task.configuration.start_date?n("el-form-item",{attrs:{label:t.$lang.columns.startDate}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.start_date))])],1):t._e(),null!==t.task.configuration.end_date?n("el-form-item",{attrs:{label:t.$lang.columns.endDate}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.task.configuration.end_date))])],1):t._e()],1):t._e()]):t._e()],1)],1):t._e()],1)]),n("el-col",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingJob,expression:"loadingJob"}],attrs:{span:18}},[0===t.jobs.length?n("el-row",[n("el-col",{attrs:{span:24}},[n("div",{staticClass:"panel"},[n("panel-title",{attrs:{title:t.$lang.objects.task}}),n("div",{staticClass:"panel-body"},[n("el-form",[n("el-form-item",{attrs:{label:t.$lang.messages.noTask}})],1)],1)],1)])],1):t._e(),t._l(t.jobs,(function(e){return n("el-row",[n("el-col",{attrs:{span:24}},[n("div",{staticClass:"panel"},[n("panel-title",{attrs:{title:e.client.name}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return t.$router.push({name:"clientSchedule",params:{id:e.client.id}})}}},[n("i",{staticClass:"fa fa-sitemap"}),t._v("\n                "+t._s(t.$lang.buttons.schedule)+"\n              ")])],1),n("div",{staticClass:"panel-body"},[n("el-row",[n("el-col",{attrs:{span:8}},[n("el-form",{attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:t.$lang.objects.client}},[n("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("\n                        "+t._s(e.client.name)+"\n                      ")])],1),n("el-form-item",{attrs:{label:t.$lang.columns.lastTime}},[t.getLastRunTime(e)?n("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("\n                        "+t._s(t.getLastRunTime(e))+"\n                      ")]):t._e()],1),t.getNextTunTime(e)?n("el-form-item",{attrs:{label:t.$lang.columns.nextTime}},[n("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("\n                        "+t._s(t.getNextTunTime(e))+"\n                      ")])],1):t._e()],1)],1),n("el-col",{attrs:{span:5}},[n("div",{staticClass:"text-center"},[n("el-progress",{attrs:{type:"circle",color:t.$store.state.color.primary,percentage:t.getRunPercent(e)}}),n("p",{staticClass:"description m-t-sm"},[t._v("\n                      "+t._s(t.$lang.descriptions.toNextTask)+"\n                    ")])],1)]),n("el-col",{attrs:{span:4}},[n("div",{staticClass:"text-center"},[n("v-chart",{staticClass:"pie",style:{width:"100%",height:"170px"},attrs:{options:t.getRunStatusPieData(e)}}),n("p",{staticClass:"description m-t-n-lg"},[t._v("\n                      "+t._s(t.$lang.descriptions.successRate)+"\n                      "+t._s(t.getSuccessRate(e))+"%\n                    ")])],1)]),n("el-col",{attrs:{span:4}},[n("el-form",{staticClass:"m-t-md",attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:t.$lang.columns.success}},[n("h1",{staticClass:"number",style:{color:t.$store.state.color.primary}},[t._v("\n                        "+t._s(t.getSuccessExecutions(e).length)+"\n                      ")])]),n("el-form-item",{attrs:{label:t.$lang.columns.error}},[n("h1",{staticClass:"number",style:{color:t.$store.state.color.error}},[t._v("\n                        "+t._s(t.getErrorExecutions(e).length)+"\n                      ")])])],1)],1)],1)],1)],1)])],1)}))],2)],1)],1)},a=[],r=n("eee4"),i=(n("c037"),n("007d"),n("7c3c")),o={data:function(){return{id:this.$route.params.id,jobs:[],task:null,loadingJob:!1,errorSymbol:"error",openDate:i.asString(this.$store.state.dateFormat,new Date)}},computed:{},mounted:function(){var t=this;this.$store.commit("addInterval",setInterval((function(){t.getJobsData()}),3e3)),this.getTaskData()},methods:{getJobsData:function(){var t=this;this.$http.get(this.formatString(this.$store.state.url.task.status,{id:this.id})).then((function(e){var n=e.data.data;t.jobs=n})).catch((function(){t.$message.error(t.$store.getters.$lang.messages.loadError)}))},getTaskData:function(){var t=this;this.$message.info(this.$store.getters.$lang.messages.gettingTaskData),this.id&&this.$http.get(this.formatString(this.$store.state.url.task.info,{id:this.id})).then((function(e){var n=e.data.data;t.task=n})).catch((function(){t.$message.error(t.$store.getters.$lang.messages.loadError)}))},getNextTunTime:function(t){return t&&t.next?i.asString(this.$store.state.dateFormat,new Date(Date.parse(t.next))):null},getLastRunTime:function(t){if(!t||!t.executions||!t.executions.length>0)return null;var e=t.executions[0];if(!e||!e.fields||!e.fields.run_time)return null;var n=e.fields.run_time;return i.asString(this.$store.state.dateFormat,new Date(Date.parse(n)))},getRunPercent:function(t){if(!t)return 0;var e=Date.parse(this.getLastRunTime(t));e&&!isNaN(e)||(e=Date.parse(this.openDate));var n=Date.parse(this.getNextTunTime(t));if(!n)return 0;var s=Date.parse(new Date),a=parseInt(100*(s-e)/(n-e));return a},getSuccessExecutions:function(t){var e=this;return!t||!t.executions||!t.executions.length>0?[]:t.executions.filter((function(t){return-1===t.fields.status.toLowerCase().indexOf(e.errorSymbol)}))},getErrorExecutions:function(t){var e=this;return!t||!t.executions||!t.executions.length>0?[]:t.executions.filter((function(t){return t.fields.status.toLowerCase().indexOf(e.errorSymbol)>=0}))},getSuccessRate:function(t){if(!t)return 0;var e=this.getSuccessExecutions(t),n=this.getErrorExecutions(t);if(e.length+n.length===0)return 0;var s=parseInt(100*e.length/(e.length+n.length));return s},getRunStatusPieData:function(t){var e=this.getSuccessExecutions(t),n=this.getErrorExecutions(t);return{color:[this.$store.state.color.primary,this.$store.state.color.error],tooltip:{show:!0,formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:this.$lang.descriptions.successRate,type:"pie",data:[{value:e.length,name:this.$lang.columns.success},{value:n.length,name:this.$lang.columns.error}]}]}}},components:{PanelTitle:r["a"]}},l=o,u=(n("6f72"),n("2877")),c=Object(u["a"])(l,s,a,!1,null,"eb76b16a",null);e["default"]=c.exports},"6f72":function(t,e,n){"use strict";n("2a0c")},"7c3c":function(t,e,n){"use strict";function s(t,e){var n=t.toString();while(n.length<e)n="0"+n;return n}function a(t){return s(t,2)}function r(t){var e=Math.abs(t),n=String(Math.floor(e/60)),s=String(e%60);return 1===n.length&&(n="0"+n),1===s.length&&(s="0"+s),t<0?"+"+n+s:"-"+n+s}function i(t,e,n){return e?t["getUTC"+n]():t["get"+n]()}function o(e,n){"string"!==typeof e&&(n=e,e=t.exports.ISO8601_FORMAT),n||(n=t.exports.now());var o=e.indexOf("O")>-1,l=a(i(n,o,"Date")),u=a(i(n,o,"Month")+1),c=a(i(n,o,"FullYear")),m=a(c.substring(2,4)),g=e.indexOf("yyyy")>-1?c:m,p=a(i(n,o,"Hours")),f=a(i(n,o,"Minutes")),d=a(i(n,o,"Seconds")),_=s(i(n,o,"Milliseconds"),3),h=r(n.getTimezoneOffset()),y=e.replace(/dd/g,l).replace(/MM/g,u).replace(/y{1,4}/g,g).replace(/hh/g,p).replace(/mm/g,f).replace(/ss/g,d).replace(/SSS/g,_).replace(/O/g,h);return y}function l(e,n,s){var a=[{pattern:/y{1,4}/,regexp:"\\d{1,4}",fn:function(t,e){t.setFullYear(e)}},{pattern:/MM/,regexp:"\\d{1,2}",fn:function(t,e){t.setMonth(e-1)}},{pattern:/dd/,regexp:"\\d{1,2}",fn:function(t,e){t.setDate(e)}},{pattern:/hh/,regexp:"\\d{1,2}",fn:function(t,e){t.setHours(e)}},{pattern:/mm/,regexp:"\\d\\d",fn:function(t,e){t.setMinutes(e)}},{pattern:/ss/,regexp:"\\d\\d",fn:function(t,e){t.setSeconds(e)}},{pattern:/SSS/,regexp:"\\d\\d\\d",fn:function(t,e){t.setMilliseconds(e)}},{pattern:/O/,regexp:"[+-]\\d{3,4}|Z",fn:function(t,e){"Z"===e&&(e=0);var n=Math.abs(e),s=n%100+60*Math.floor(n/100);t.setMinutes(t.getMinutes()+(e>0?s:-s))}}],r=a.reduce((function(t,e){return e.pattern.test(t.regexp)?(e.index=t.regexp.match(e.pattern).index,t.regexp=t.regexp.replace(e.pattern,"("+e.regexp+")")):e.index=-1,t}),{regexp:e,index:[]}),i=a.filter((function(t){return t.index>-1}));i.sort((function(t,e){return t.index-e.index}));var o=new RegExp(r.regexp),l=o.exec(n);if(l){var u=s||t.exports.now();return i.forEach((function(t,e){t.fn(u,l[e+1])})),u}throw new Error("String '"+n+"' could not be parsed as '"+e+"'")}function u(t,e,n){if(!t)throw new Error("pattern must be supplied");return l(t,e,n)}function c(){return new Date}t.exports=o,t.exports.asString=o,t.exports.parse=u,t.exports.now=c,t.exports.ISO8601_FORMAT="yyyy-MM-ddThh:mm:ss.SSS",t.exports.ISO8601_WITH_TZ_OFFSET_FORMAT="yyyy-MM-ddThh:mm:ss.SSSO",t.exports.DATETIME_FORMAT="dd MM yyyy hh:mm:ss.SSS",t.exports.ABSOLUTETIME_FORMAT="hh:mm:ss.SSS"}}]);
//# sourceMappingURL=chunk-ce1a440a.47ce1a72.js.map